<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IoT NIST Monitor - Incident Response</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .severity-critical {
        background-color: #dc3545;
        color: white;
      }
      .severity-high {
        background-color: #fd7e14;
        color: white;
      }
      .severity-medium {
        background-color: #ffc107;
        color: black;
      }
      .severity-low {
        background-color: #198754;
        color: white;
      }

      .status-open {
        background-color: #0d6efd;
        color: white;
      }
      .status-in_progress {
        background-color: #ffc107;
        color: black;
      }
      .status-contained {
        background-color: #0dcaf0;
        color: black;
      }
      .status-resolved {
        background-color: #198754;
        color: white;
      }

      .card-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .incident-timeline {
        border-left: 3px solid #0d6efd;
        padding-left: 20px;
        margin-left: 10px;
      }

      .timeline-event {
        position: relative;
        margin-bottom: 20px;
      }

      .timeline-event::before {
        content: "";
        position: absolute;
        left: -26px;
        top: 5px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #0d6efd;
      }

      .action-btn {
        transition: all 0.2s ease;
      }

      .action-btn:hover {
        transform: scale(1.05);
      }

      #incidentDetailsModal .modal-dialog {
        max-width: 800px;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid py-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center">
            <h2 class="text-primary">
              <i class="fas fa-fire-extinguisher me-2"></i>NIST Respond -
              Incident Response Center
            </h2>
            <button class="btn btn-primary" onclick="showCreateIncidentModal()">
              <i class="fas fa-plus me-1"></i>New Incident
            </button>
          </div>
          <p class="text-muted">
            Manage and respond to security incidents across your IoT
            infrastructure
          </p>
        </div>
      </div>

      <!-- Statistics Cards -->
      <div class="row mb-4">
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-primary text-white">
            <div class="card-body text-center">
              <h3 id="stat-open">0</h3>
              <small>Open Incidents</small>
            </div>
          </div>
        </div>
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-warning text-dark">
            <div class="card-body text-center">
              <h3 id="stat-high">0</h3>
              <small>High Severity</small>
            </div>
          </div>
        </div>
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-danger text-white">
            <div class="card-body text-center">
              <h3 id="stat-critical">0</h3>
              <small>Critical</small>
            </div>
          </div>
        </div>
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-success text-white">
            <div class="card-body text-center">
              <h3 id="stat-auto">0</h3>
              <small>Auto-Resolved</small>
            </div>
          </div>
        </div>
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-info text-white">
            <div class="card-body text-center">
              <h3 id="stat-total">0</h3>
              <small>Total Today</small>
            </div>
          </div>
        </div>
        <div class="col-xl-2 col-md-4 col-6 mb-3">
          <div class="card card-hover bg-secondary text-white">
            <div class="card-body text-center">
              <h3 id="stat-avg">0m</h3>
              <small>Avg Response</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-light">
              <h5 class="mb-0">
                <i class="fas fa-bolt me-2"></i>Quick Response Actions
              </h5>
            </div>
            <div class="card-body">
              <div class="d-flex flex-wrap gap-2">
                <button
                  class="btn btn-outline-danger action-btn"
                  onclick="showQuarantineModal()"
                >
                  <i class="fas fa-shield-alt me-1"></i>Quarantine Device
                </button>
                <button
                  class="btn btn-outline-warning action-btn"
                  onclick="showBlockIPModal()"
                >
                  <i class="fas fa-ban me-1"></i>Block IP
                </button>
                <button
                  class="btn btn-outline-info action-btn"
                  onclick="showCreateTicketModal()"
                >
                  <i class="fas fa-ticket-alt me-1"></i>Create Ticket
                </button>
                <button
                  class="btn btn-outline-success action-btn"
                  onclick="showAlertModal()"
                >
                  <i class="fas fa-bell me-1"></i>Send Alert
                </button>
                <button
                  class="btn btn-outline-primary action-btn"
                  onclick="showPlaybookModal()"
                >
                  <i class="fas fa-play-circle me-1"></i>Run Playbook
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Incidents Table -->
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div
              class="card-header bg-light d-flex justify-content-between align-items-center"
            >
              <h5 class="mb-0">
                <i class="fas fa-list me-2"></i>Active Incidents
              </h5>
              <div>
                <select
                  id="filter-status"
                  class="form-select form-select-sm d-inline-block w-auto"
                  onchange="loadIncidents()"
                >
                  <option value="">All Status</option>
                  <option value="open">Open</option>
                  <option value="in_progress">In Progress</option>
                  <option value="contained">Contained</option>
                  <option value="resolved">Resolved</option>
                </select>
                <select
                  id="filter-severity"
                  class="form-select form-select-sm d-inline-block w-auto ms-2"
                  onchange="loadIncidents()"
                >
                  <option value="">All Severity</option>
                  <option value="critical">Critical</option>
                  <option value="high">High</option>
                  <option value="medium">Medium</option>
                  <option value="low">Low</option>
                </select>
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover table-striped">
                  <thead class="table-dark">
                    <tr>
                      <th>ID</th>
                      <th>Title</th>
                      <th>Severity</th>
                      <th>Status</th>
                      <th>Device</th>
                      <th>Detected</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="incidents-table-body">
                    <!-- Incidents will be loaded here -->
                  </tbody>
                </table>
              </div>
              <div class="text-center mt-3">
                <div
                  class="spinner-border text-primary"
                  id="loading-spinner"
                  role="status"
                >
                  <span class="visually-hidden">Loading...</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Incident Modal -->
    <div class="modal fade" id="createIncidentModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create New Incident</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="create-incident-form">
              <div class="mb-3">
                <label class="form-label">Title *</label>
                <input
                  type="text"
                  class="form-control"
                  id="incident-title"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea
                  class="form-control"
                  id="incident-description"
                  rows="3"
                ></textarea>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Severity *</label>
                    <select class="form-select" id="incident-severity" required>
                      <option value="low">Low</option>
                      <option value="medium">Medium</option>
                      <option value="high">High</option>
                      <option value="critical">Critical</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Type</label>
                    <select class="form-select" id="incident-type">
                      <option value="">Select Type</option>
                      <option value="malware">Malware</option>
                      <option value="unauthorized_access">
                        Unauthorized Access
                      </option>
                      <option value="data_breach">Data Breach</option>
                      <option value="ddos">DDoS Attack</option>
                      <option value="device_tampering">Device Tampering</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Device ID (optional)</label>
                <input
                  type="number"
                  class="form-control"
                  id="incident-device-id"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="createIncident()"
            >
              Create Incident
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Quarantine Device Modal -->
    <div class="modal fade" id="quarantineModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Quarantine Device</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Device ID *</label>
              <input
                type="number"
                class="form-control"
                id="quarantine-device-id"
                required
              />
            </div>
            <div class="mb-3">
              <label class="form-label">Reason</label>
              <textarea
                class="form-control"
                id="quarantine-reason"
                rows="2"
              ></textarea>
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                id="quarantine-isolation"
              />
              <label class="form-check-label"
                >Isolate from network immediately</label
              >
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="quarantineDevice()"
            >
              Quarantine Device
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Incident Details Modal -->
    <div class="modal fade" id="incidentDetailsModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              Incident Details - <span id="detail-title"></span>
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-6">
                <h6>Basic Information</h6>
                <table class="table table-sm">
                  <tr>
                    <th>ID:</th>
                    <td id="detail-id"></td>
                  </tr>
                  <tr>
                    <th>Severity:</th>
                    <td id="detail-severity"></td>
                  </tr>
                  <tr>
                    <th>Status:</th>
                    <td id="detail-status"></td>
                  </tr>
                  <tr>
                    <th>Type:</th>
                    <td id="detail-type"></td>
                  </tr>
                  <tr>
                    <th>Device ID:</th>
                    <td id="detail-device-id"></td>
                  </tr>
                </table>
              </div>
              <div class="col-md-6">
                <h6>Timeline</h6>
                <div class="incident-timeline">
                  <div id="detail-timeline">
                    <!-- Timeline will be populated here -->
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-12">
                <h6>Description</h6>
                <p id="detail-description" class="border p-2 rounded"></p>
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-12">
                <h6>Response Actions</h6>
                <div id="detail-actions" class="border p-2 rounded">
                  <!-- Actions will be populated here -->
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-warning"
              onclick="takeActionOnCurrentIncident('quarantine')"
            >
              Quarantine
            </button>
            <button
              type="button"
              class="btn btn-success"
              onclick="updateIncidentStatus('resolved')"
            >
              Mark Resolved
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Global variables
      let currentIncidentId = null;
      let allIncidents = [];

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", function () {
        loadIncidents();

        // Refresh every 30 seconds
        setInterval(loadIncidents, 30000);
      });

      // Load incidents from API
      async function loadIncidents() {
        const spinner = document.getElementById("loading-spinner");
        const tbody = document.getElementById("incidents-table-body");

        spinner.style.display = "block";
        tbody.innerHTML = "";

        try {
          const response = await fetch("/api/incidents");
          allIncidents = await response.json();
          renderIncidents();
          updateStatistics();
        } catch (error) {
          console.error("Error loading incidents:", error);
          tbody.innerHTML =
            '<tr><td colspan="7" class="text-center text-danger">Error loading incidents</td></tr>';
        } finally {
          spinner.style.display = "none";
        }
      }

      // Render incidents table
      function renderIncidents() {
        const tbody = document.getElementById("incidents-table-body");
        const statusFilter = document.getElementById("filter-status").value;
        const severityFilter = document.getElementById("filter-severity").value;

        let filteredIncidents = allIncidents;

        if (statusFilter) {
          filteredIncidents = filteredIncidents.filter(
            (incident) => incident.status === statusFilter
          );
        }

        if (severityFilter) {
          filteredIncidents = filteredIncidents.filter(
            (incident) => incident.severity === severityFilter
          );
        }

        if (filteredIncidents.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="7" class="text-center text-muted">No incidents found</td></tr>';
          return;
        }

        tbody.innerHTML = filteredIncidents
          .map(
            (incident) => `
                <tr>
                    <td><strong>#${incident.id}</strong></td>
                    <td>${incident.title}</td>
                    <td><span class="badge severity-${
                      incident.severity
                    }">${incident.severity.toUpperCase()}</span></td>
                    <td><span class="badge status-${
                      incident.status
                    }">${incident.status
              .replace("_", " ")
              .toUpperCase()}</span></td>
                    <td>${
                      incident.device_id
                        ? `Device ${incident.device_id}`
                        : "N/A"
                    }</td>
                    <td>${new Date(incident.detected_at).toLocaleString()}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="viewIncident(${
                          incident.id
                        })" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-warning me-1" onclick="takeAction(${
                          incident.id
                        }, 'quarantine')" title="Quarantine">
                            <i class="fas fa-shield-alt"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="updateIncidentStatus(${
                          incident.id
                        }, 'resolved')" title="Mark Resolved">
                            <i class="fas fa-check"></i>
                        </button>
                    </td>
                </tr>
            `
          )
          .join("");
      }

      // Update statistics
      function updateStatistics() {
        const openIncidents = allIncidents.filter(
          (i) => i.status === "open"
        ).length;
        const highSeverity = allIncidents.filter(
          (i) => i.severity === "high"
        ).length;
        const criticalSeverity = allIncidents.filter(
          (i) => i.severity === "critical"
        ).length;
        const autoActions = allIncidents.filter(
          (i) => i.automatic_actions_taken
        ).length;
        const totalToday = allIncidents.filter((i) => {
          const today = new Date().toDateString();
          return new Date(i.detected_at).toDateString() === today;
        }).length;

        document.getElementById("stat-open").textContent = openIncidents;
        document.getElementById("stat-high").textContent = highSeverity;
        document.getElementById("stat-critical").textContent = criticalSeverity;
        document.getElementById("stat-auto").textContent = autoActions;
        document.getElementById("stat-total").textContent = totalToday;
      }

      // Modal control functions
      function showCreateIncidentModal() {
        const modal = new bootstrap.Modal(
          document.getElementById("createIncidentModal")
        );
        modal.show();
      }

      function showQuarantineModal() {
        const modal = new bootstrap.Modal(
          document.getElementById("quarantineModal")
        );
        modal.show();
      }

      function showBlockIPModal() {
        const ip = prompt("Enter IP address to block:");
        if (ip) {
          takeManualAction("block_ip", { ip_address: ip });
        }
      }

      function showCreateTicketModal() {
        alert("Ticket creation would integrate with Jira/ServiceNow here");
      }

      function showAlertModal() {
        alert("Alert system would notify teams via Slack/Email here");
      }

      function showPlaybookModal() {
        alert("Playbook execution interface would appear here");
      }

      // API functions
      async function createIncident() {
        const form = document.getElementById("create-incident-form");
        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }

        const incidentData = {
          title: document.getElementById("incident-title").value,
          description: document.getElementById("incident-description").value,
          severity: document.getElementById("incident-severity").value,
          incident_type: document.getElementById("incident-type").value,
          device_id:
            document.getElementById("incident-device-id").value || null,
        };

        try {
          const response = await fetch("/api/incidents", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(incidentData),
          });

          if (response.ok) {
            const modal = bootstrap.Modal.getInstance(
              document.getElementById("createIncidentModal")
            );
            modal.hide();
            form.reset();
            loadIncidents();
            showAlert("Incident created successfully!", "success");
          } else {
            throw new Error("Failed to create incident");
          }
        } catch (error) {
          console.error("Error creating incident:", error);
          showAlert("Error creating incident", "error");
        }
      }

      async function quarantineDevice() {
        const deviceId = document.getElementById("quarantine-device-id").value;
        const reason = document.getElementById("quarantine-reason").value;
        const isolate = document.getElementById("quarantine-isolation").checked;

        if (!deviceId) {
          alert("Please enter a device ID");
          return;
        }

        try {
          const result = await takeManualAction("quarantine_device", {
            device_id: parseInt(deviceId),
            reason: reason,
            isolate: isolate,
          });

          const modal = bootstrap.Modal.getInstance(
            document.getElementById("quarantineModal")
          );
          modal.hide();
          showAlert(`Device ${deviceId} quarantined successfully`, "success");
        } catch (error) {
          showAlert("Error quarantining device", "error");
        }
      }

      async function takeManualAction(actionType, parameters) {
        try {
          const response = await fetch("/api/incidents/actions", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              action_type: actionType,
              parameters: parameters,
            }),
          });

          const result = await response.json();
          return result;
        } catch (error) {
          console.error("Error taking action:", error);
          throw error;
        }
      }

      async function takeAction(incidentId, actionType) {
        if (actionType === "quarantine") {
          if (
            !confirm(
              "Are you sure you want to quarantine the device associated with this incident?"
            )
          )
            return;

          try {
            const response = await fetch(
              `/api/incidents/${incidentId}/actions`,
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  action_type: "quarantine_device",
                  parameters: {},
                }),
              }
            );

            const result = await response.json();
            showAlert("Quarantine action executed", "success");
            loadIncidents();
          } catch (error) {
            console.error("Error taking action:", error);
            showAlert("Error executing action", "error");
          }
        }
      }

      async function viewIncident(incidentId) {
        currentIncidentId = incidentId;
        const incident = allIncidents.find((i) => i.id === incidentId);

        if (!incident) return;

        // Populate details
        document.getElementById("detail-title").textContent = incident.title;
        document.getElementById("detail-id").textContent = incident.id;
        document.getElementById(
          "detail-severity"
        ).innerHTML = `<span class="badge severity-${
          incident.severity
        }">${incident.severity.toUpperCase()}</span>`;
        document.getElementById(
          "detail-status"
        ).innerHTML = `<span class="badge status-${
          incident.status
        }">${incident.status.replace("_", " ").toUpperCase()}</span>`;
        document.getElementById("detail-type").textContent =
          incident.incident_type || "Not specified";
        document.getElementById("detail-device-id").textContent =
          incident.device_id || "N/A";
        document.getElementById("detail-description").textContent =
          incident.description || "No description provided";

        // Populate timeline
        const timeline = document.getElementById("detail-timeline");
        timeline.innerHTML = `
                <div class="timeline-event">
                    <strong>Incident Detected</strong>
                    <div class="text-muted">${new Date(
                      incident.detected_at
                    ).toLocaleString()}</div>
                </div>
                ${
                  incident.contained_at
                    ? `
                <div class="timeline-event">
                    <strong>Incident Contained</strong>
                    <div class="text-muted">${new Date(
                      incident.contained_at
                    ).toLocaleString()}</div>
                </div>
                `
                    : ""
                }
                ${
                  incident.resolved_at
                    ? `
                <div class="timeline-event">
                    <strong>Incident Resolved</strong>
                    <div class="text-muted">${new Date(
                      incident.resolved_at
                    ).toLocaleString()}</div>
                </div>
                `
                    : ""
                }
            `;

        // Populate actions
        const actionsDiv = document.getElementById("detail-actions");
        const autoActions = incident.automatic_actions_taken
          ? JSON.parse(incident.automatic_actions_taken)
          : [];
        const manualActions = incident.manual_actions_taken
          ? JSON.parse(incident.manual_actions_taken)
          : [];

        if (autoActions.length === 0 && manualActions.length === 0) {
          actionsDiv.innerHTML =
            '<p class="text-muted">No response actions taken yet</p>';
        } else {
          actionsDiv.innerHTML = [
            ...autoActions.map(
              (action) => `
                        <div class="mb-2">
                            <i class="fas fa-robot text-primary me-1"></i>
                            <strong>Auto:</strong> ${action.playbook} - ${action.action.type}
                            <br><small class="text-muted">Result: ${action.result.status}</small>
                        </div>
                    `
            ),
            ...manualActions.map(
              (action) => `
                        <div class="mb-2">
                            <i class="fas fa-user text-success me-1"></i>
                            <strong>Manual:</strong> ${action.action_type}
                            <br><small class="text-muted">${new Date(
                              action.timestamp
                            ).toLocaleString()}</small>
                        </div>
                    `
            ),
          ].join("");
        }

        const modal = new bootstrap.Modal(
          document.getElementById("incidentDetailsModal")
        );
        modal.show();
      }

      async function updateIncidentStatus(incidentId, status) {
        if (incidentId === "resolved" && currentIncidentId) {
          // Handle the case from details modal
          incidentId = currentIncidentId;
          status = "resolved";
        }

        try {
          const response = await fetch(`/api/incidents/${incidentId}`, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              status: status,
            }),
          });

          if (response.ok) {
            showAlert(`Incident status updated to ${status}`, "success");
            loadIncidents();

            // Close details modal if open
            const detailsModal = bootstrap.Modal.getInstance(
              document.getElementById("incidentDetailsModal")
            );
            if (detailsModal) {
              detailsModal.hide();
            }
          } else {
            throw new Error("Failed to update incident");
          }
        } catch (error) {
          console.error("Error updating incident:", error);
          showAlert("Error updating incident status", "error");
        }
      }

      function takeActionOnCurrentIncident(actionType) {
        if (currentIncidentId) {
          takeAction(currentIncidentId, actionType);
        }
      }

      // Utility functions
      function showAlert(message, type) {
        // Simple alert implementation - you might want to use a more sophisticated notification system
        alert(`${type.toUpperCase()}: ${message}`);
      }

      // Export functions for global access
      window.loadIncidents = loadIncidents;
      window.showCreateIncidentModal = showCreateIncidentModal;
      window.showQuarantineModal = showQuarantineModal;
      window.showBlockIPModal = showBlockIPModal;
      window.showCreateTicketModal = showCreateTicketModal;
      window.showAlertModal = showAlertModal;
      window.showPlaybookModal = showPlaybookModal;
      window.createIncident = createIncident;
      window.quarantineDevice = quarantineDevice;
      window.takeAction = takeAction;
      window.viewIncident = viewIncident;
      window.updateIncidentStatus = updateIncidentStatus;
      window.takeActionOnCurrentIncident = takeActionOnCurrentIncident;
    </script>
  </body>
</html>
